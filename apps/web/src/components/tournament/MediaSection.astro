---
// Медиа галерея - лучшие моменты прошлого турнира
import Image from "astro/components/Image.astro";
import heroBg from '../../assets/tournament/hero-bg.png';
import balls2 from '../../assets/tournament/balls_2.png';
import mediaLogoBig from '../../assets/tournament/media-logo-big.png';
import media from '../../content/media/index.json';
---

<section class="w-full bg-tournament-dark flex flex-col" id="media">
  
  <!-- Block 1: Header & Player -->
  <div class="relative w-full overflow-hidden flex justify-center pt-[67px] pb-[50px] z-2">
    <!-- Background Top -->
    <div class="absolute top-0 left-0 w-full h-full pointer-events-none z-0">
      <img src="/tournament/bg-elements-media.svg" class="absolute left-1/2 -translate-x-1/2 top-0 max-w-none h-auto" alt="" />
    </div>

    <div class="relative z-1 w-full max-w-[1440px] flex flex-col items-center">
      <header class="text-center mb-[54px] md:mb-8">
        <h2 class="text-6xl font-bold text-white leading-none m-0 md:text-5xl">Медиа галерея</h2>
        <p class="text-base font-semibold text-white mt-2.5 mb-0 opacity-80">Лучшие моменты прошлого турнира</p>
      </header>

      <div class="w-[1160px] max-w-[95%] aspect-video bg-[#2C2C2C] border-4 border-tournament-orange rounded-[5px] shadow-[0px_4px_4px_rgba(216,90,33,1)] flex justify-center items-center relative md:border-[3px]">
        <a href={media.videoUrl} target="_blank" class="bg-none border-none cursor-pointer w-[142px] h-[142px] transition-transform duration-200 hover:scale-105 md:w-20 md:h-20" aria-label="Воспроизвести видео">
          <img src="/tournament/icon-play.svg" alt="Play" class="w-full h-full" />
        </a>
      </div>
    </div>
  </div>

  <!-- Divider -->
  <div class="relative w-full h-[46px] bg-tournament-orange z-3 md:h-[30px]"></div>

  <!-- Block 2: Gallery Grid -->
  <div class="relative w-full overflow-hidden flex justify-center pt-[50px] pb-[50px] z-1 max-lg:pt-[30px]">
    <!-- Background Bottom -->
    <div class="absolute top-0 left-0 w-full h-full pointer-events-none z-0">
      <Image src={balls2} format="avif" quality="high" width={1707} height={960} class="absolute left-1/2 -translate-x-1/2 w-[1707px] max-w-none h-auto" alt="" loading="lazy" />
    </div>

    <div class="relative z-1 w-full max-w-[1440px] flex flex-col items-center px-4">
      <div class="relative w-full max-w-[1414px]">
        
        <!-- Logo Layer (Overlapping) - скрыт на маленьких экранах -->
        <div class="absolute top-75 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10 pointer-events-none max-lg:hidden">
          <Image src={mediaLogoBig} alt="Logo" format="avif" quality="high" width={650} height={650} class="w-[650px]" loading="lazy" />
        </div>

        <!-- Windows Grid - 5 карточек вокруг лого -->
        <div class="gallery-grid">
          {media.gallery.map((item, index) => {
            const Tag = item.link ? 'a' : 'div';
            const extraProps = item.link ? { href: item.link, target: "_blank" } : {};
            
            return (
              <Tag 
                {...extraProps}
                class={`gallery-card gallery-card-${index + 1} group`}
                style={`background-image: url('${item.image}');`}
              >
                <div class="w-full h-full bg-black/40 group-hover:bg-transparent transition-colors duration-300">
                  {item.alt && (
                    <div class="absolute bottom-0 left-0 w-full bg-black/60 p-2 translate-y-full group-hover:translate-y-0 transition-transform duration-300">
                      <p class="text-white text-[10px] font-bold uppercase text-center m-0">{item.alt}</p>
                    </div>
                  )}
                </div>
              </Tag>
            );
          })}
        </div>

      </div>
    </div>
  </div>

</section>

<style>
  .gallery-grid {
    position: relative;
    width: 100%;
    aspect-ratio: 16/9;
  }

  .gallery-card {
    position: absolute;
    width: 450px;
    aspect-ratio: 16 / 9;
    background-color: #2C2C2C;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    border: 4px solid #D85921;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25);
    text-decoration: none;
  }

  /* Верхняя левая - чуть выше и левее */
  .gallery-card-1 {
    top: -4%;
    left: 0%;
  }

  /* Верхняя правая - чуть выше и правее */
  .gallery-card-2 {
    top: -4%;
    right: 5%;
  }

  /* Средняя левая - чуть ниже середины */
  .gallery-card-3 {
    top: 45%;
    left: 1%;
  }

  /* Средняя правая - чуть выше середины */
  .gallery-card-4 {
    top: 45%;
    right: 0%;
  }

  /* Нижняя центральная - смещена вправо */
  .gallery-card-5 {
    bottom: 5%;
    left: 51%;
    transform: translateX(-50%);
  }

  /* Responsive: на маленьких экранах - стопка */
  @media (max-width: 1023px) {
    .gallery-grid {
      aspect-ratio: auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }

    .gallery-card {
      position: relative;
      width: 400px;
      max-width: 90%;
      height: 200px;
      transform: none;
      top: auto;
      left: auto;
      right: auto;
      bottom: auto;
    }
  }
</style>
